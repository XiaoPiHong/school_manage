var pe=Object.defineProperty;var me=(e,t,a)=>t in e?pe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var l=(e,t,a)=>(me(e,typeof t!="symbol"?t+"":t,a),a);import{r as y,F as ge,S as Y,i as de,j as J,k as he,R as be,C as U,l as j,m as g,n as X,p as Z,q as Fe,d as Ee,s as fe,E as S,t as Se,o as E,c as I,a as ee,v as L,x as V,y as x,z as r,e as q,A as Ce,w as te,f as Be,B as De,g as D,D as Ae}from"./index.9c5ffd75.js";import{r as W,M as O,C as ve}from"./request.61a11b1f.js";class ye{constructor(t={}){l(this,"loading");l(this,"data");l(this,"sort");l(this,"selection");l(this,"sorting");l(this,"defaultSort");this.loading=t.loading||!1,this.data=t.data||[],this.sort=t.sort||{isAsc:null,sortColumns:null},this.defaultSort=t.defaultSort||{isAsc:null,sortColumns:null},this.selection=t.selection||[],this.sorting=t.sorting||!1}update(t){Object.keys(t).forEach(a=>{this[a]=t[a]})}getData(){return this.data}}class C{constructor(t){l(this,"prop");l(this,"label");l(this,"minWidth");l(this,"align");l(this,"sortable");this.prop=t.prop,this.label=t.label||"",this.minWidth=t.minWidth||"80",this.align=t.align||"center",this.sortable=typeof t.sortable=="boolean"?t.sortable:"custom"}}class we{constructor(t={}){l(this,"pageSize");l(this,"total");l(this,"currentPage");l(this,"pageSizes");l(this,"layout");this.pageSize=t.pageSize||30,this.total=t.total||0,this.layout=t.layout||"total, prev, pager, next, jumper, sizes",this.currentPage=typeof t.currentPage>"u"?1:t.currentPage,this.pageSizes=t.pageSizes||[30,100,300]}update(t){Object.keys(t).forEach(a=>{this[a]=t[a]})}}function K(e){return{form:y(new ge(e))}}function ke(e){return{pagination:y(new we(e))}}function _e(e,t){const a=y(new ye(t.tableProps)),{dataApi:c,dataFormat:p,paginationProps:A,searchForm:v}=t,{pagination:i}=ke(A),w=()=>{a.update({loading:!0});const d={pageIndex:i.currentPage,pageSize:i.pageSize,orderBy:"",search:""};if(typeof a.defaultSort.isAsc=="boolean"){const s=a.defaultSort.isAsc?"asc":"desc";d.orderBy=`${a.defaultSort.sortColumns} ${s}`}if(typeof a.sort.isAsc=="boolean"){const s=a.sort.isAsc?"asc":"desc";d.orderBy=`${a.sort.sortColumns} ${s}`}const h=(s,m)=>{const{tname:F="",cname:n="",typename:u="",operate:b=""}=s;n&&m&&(B.push(F),k.push(n),_.push(u),P.push(b),T.push(m))},B=[],k=[],_=[],P=[],T=[];v.list.forEach(s=>{const m=s.getOption();if(m.length>0)switch(s._type){case Y.SEARCH_KEY_INPUT:h(m[0],s.getValue().value);break;case Y.RANGE_INPUT:h(m[0],s.getValue().value[0]),h(m[1],s.getValue().value[1]);break;default:h(m[0],s.getValue())}});const z=`${B.join("`")}|${k.join("`")}|${T.join("`")}|${P.join("`")}|${_.join("`")}`;return d.search=z,c(d).then(s=>{const{page:m,records:F,rows:n}=s.Data;a.update({data:typeof p=="function"?p(n):n}),i.update({total:F,currentPage:m})}).finally(()=>{a.update({loading:!1})})};return{table:a,columns:e,pagination:i,getTableData:w,onSortChange:({prop:d,order:h})=>{const B={ascending:!0,descending:!1};return a.update({sort:{isAsc:h!==null?B[h]:h,sortColumns:d}}),w()},onSelectionChange:d=>{a.selection=d}}}function Pe(e){return{searchForm:y(new de(e))}}var oe=(e=>(e.\u6B3E\u5230\u53D1\u8D27="1",e.\u8D27\u5230\u4ED8\u6B3E="2",e.\u8D26\u671F\u4ED8\u6B3E_\u5468\u7ED3="3",e.\u8D26\u671F\u4ED8\u6B3E_\u534A\u6708\u7ED3="4",e.\u8D26\u671F\u4ED8\u6B3E_\u6708\u7ED3="5",e.\u5176\u5B83="6",e))(oe||{});const N=oe;var le=(e=>(e.\u94F6\u884C\u8F6C\u8D26="1",e.\u652F\u4ED8\u5B9D="2",e.\u5176\u4ED6="3",e))(le||{});const M=le;function ae(e={}){const{searchKeyInput:t}=e;return{list:[new J({prop:"SettlementMethod",placeholder:"\u7ED3\u7B97\u65B9\u5F0F",options:Object.keys(N).map(a=>({value:N[a],label:a,operate:"eq",tname:"s",cname:"SettlementMethod"}))}),new J({prop:"PaymentMethod",placeholder:"\u652F\u4ED8\u65B9\u5F0F",options:Object.keys(M).map(a=>({value:M[a],label:a,operate:"eq",tname:"s",cname:"PaymentMethod"}))}),new he({prop:"SearchKeyInput",options:[{value:"SupplierName",label:"\u4F9B\u5E94\u5546\u540D\u79F0",cname:"SupplierName",tname:"s",operate:"like"},{value:"Contacts",label:"\u8054\u7CFB\u4EBA",cname:"Contacts",tname:"s",operate:"like"},{value:"MobilePhone",label:"\u624B\u673A",cname:"MobilePhone",tname:"s",operate:"like"},{value:"Telephone",label:"\u7535\u8BDD",cname:"Telephone",tname:"s",operate:"like"},{value:"QQ",label:"QQ",cname:"QQ",tname:"s",operate:"like",typename:""},{value:"Mailbox",label:"\u90AE\u7BB1",cname:"Mailbox",tname:"s",operate:"like"},{value:"Wangwang",label:"\u65FA\u65FA",cname:"Wangwang",tname:"s",operate:"like"},{value:"BankName",label:"\u94F6\u884C\u540D\u79F0",cname:"BankName",tname:"s",operate:"like"},{value:"BankAccount",label:"\u94F6\u884C\u8D26\u53F7",cname:"BankAccount",tname:"s",operate:"like"},{value:"AccountUserName",label:"\u5F00\u6237\u4EBA\u540D\u79F0",cname:"AccountUserName",tname:"s",operate:"like"},{value:"WebSite",label:"\u4EA7\u54C1\u7F51\u5740",cname:"WebSite",tname:"s",operate:"like"},{value:"SupplierAddress",label:"\u5730\u5740",cname:"SupplierAddress",tname:"s",operate:"like"},{value:"Remark",label:"\u5907\u6CE8",cname:"Remark",tname:"s",operate:"like"}],value:{key:"SupplierName",value:""},...t}),new be({prop:"ArrivalPeriod",prePlaceholder:">=",appendPlaceholder:"<=",options:[{value:"ArrivalPeriod",label:"\u5230\u8D27\u5468\u671F\uFF08\u5929\uFF09",cname:"ArrivalPeriod",tname:"s"}],preOption:{operate:"GreatEq"},appendOption:{operate:"LessEq"},value:{key:"ArrivalPeriod",value:["",""]},hidden:!0})]}}function Te(e){const t=[new C({prop:"SupplierName",label:"\u4F9B\u5E94\u5546\u540D\u79F0/\u5730\u5740",minWidth:"100",align:"center",sortable:!1}),new C({prop:"WebSite",label:"\u5230\u8D27\u5468\u671F/\u4EA7\u54C1\u7F51\u5740",minWidth:"100",align:"center",sortable:!1}),new C({prop:"SettlementMethod",label:"\u7ED3\u7B97\u65B9\u5F0F/\u652F\u4ED8\u65B9\u5F0F",minWidth:"120",align:"center",sortable:"custom"}),new C({prop:"BankName",label:"\u5F00\u6237\u4EBA/\u94F6\u884C\u540D\u79F0/\u94F6\u884C\u8D26\u53F7",minWidth:"180",align:"center",sortable:!1}),new C({prop:"Contacts",label:"\u8054\u7CFB\u4EBA/\u624B\u673A/\u7535\u8BDD",minWidth:"100",align:"center",sortable:!1}),new C({prop:"QQ",label:"QQ/\u90AE\u7BB1/\u65FA\u65FA",minWidth:"100",align:"center",sortable:!1}),new C({prop:"Remark",label:"\u5907\u6CE8",minWidth:"100",align:"center",sortable:!1})],{table:a,pagination:c,columns:p,getTableData:A,onSortChange:v,onSelectionChange:i}=_e(t,e);return{table:a,columns:p,pagination:c,getTableData:A,onSortChange:v,onSelectionChange:i}}function ne(e={},t={}){return{list:[new U({prop:"basicInformation",label:"\u57FA\u7840\u4FE1\u606F",value:j.THIN}),new g({label:"\u540D\u79F0",prop:"SupplierName",value:e.SupplierName,rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u5141\u8BB8\u4E3A\u7A7A",trigger:"change"}]}),new g({label:"\u5230\u8D27\u5468\u671F",prop:"ArrivalPeriod",value:e.ArrivalPeriod,append:"\u5929"}),new g({label:"\u4EA7\u54C1\u7F51\u5740",prop:"WebSite",value:e.WebSite}),new X({label:"\u5730\u5740",prop:"SupplierAddress",value:e.SupplierAddress}),new X({label:"\u5907\u6CE8",prop:"Remark",value:e.Remark}),new U({prop:"contactInformation",label:"\u8054\u7CFB\u4FE1\u606F",value:j.THIN}),new g({label:"\u8054\u7CFB\u4EBA",prop:"Contacts",value:e.Contacts}),new g({label:"\u624B\u673A",prop:"MobilePhone",value:e.MobilePhone}),new g({label:"\u7535\u8BDD",prop:"Telephone",value:e.Telephone}),new g({label:"QQ",prop:"QQ",value:e.QQ}),new g({label:"\u90AE\u7BB1",prop:"Mailbox",value:e.Mailbox}),new g({label:"\u65FA\u65FA",prop:"Wangwang",value:e.Wangwang}),new U({prop:"financialInformation",label:"\u8D22\u52A1\u4FE1\u606F",value:j.THIN}),new Z({label:"\u7ED3\u7B97\u65B9\u5F0F",value:e.SettlementMethod,prop:"SettlementMethod",options:Object.keys(N).map(a=>({value:Number(N[a]),label:a}))}),new Z({label:"\u652F\u4ED8\u65B9\u5F0F",value:e.PaymentMethod,prop:"PaymentMethod",options:Object.keys(M).map(a=>({value:Number(M[a]),label:a}))}),new g({label:"\u94F6\u884C\u540D\u79F0",prop:"BankName",value:e.BankName}),new g({label:"\u94F6\u884C\u8D26\u53F7",prop:"BankAccount",value:e.BankAccount}),new g({label:"\u5F00\u6237\u4EBA\u540D\u79F0",prop:"AccountUserName",value:e.AccountUserName})]}}function Ie(){return{list:[new Fe({label:"\u4F9B\u5E94\u5546\u6587\u4EF6",prop:"fileExcel",multiple:!1,drag:!0,limit:1,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel",autoUpload:!1,rules:[{required:!0,message:"\u6587\u4EF6\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}]})]}}const{VITE_BASE_URL:R}={VITE_BASE_URL:"http://localhost:48149",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0};function xe(e){return W({url:`${R}/Supplier`,method:O.POST,params:e})}function Ne(e){return W({url:`${R}/Supplier/Delete`,method:O.POST,params:e})}function ue(e){return W({url:`${R}/Supplier/Edit`,method:O.POST,params:e})}function Me(e){return W({url:`${R}/Supplier/ImportExcelSave`,method:O.POST,body:e,headers:{"Content-Type":ve.MULTIPART_FORM_DATA}})}const We={class:"page-container"},Oe={class:"page-container__control"},Re={class:"page-container__content"},Ue=Ee({__name:"index",setup(e){const{buttons:t}=fe([{type:"success",text:"\u6DFB\u52A0",icon:"button-add",onClick:()=>_()},{type:"success",text:"\u5BFC\u5165",icon:"button-file-import",onClick:()=>P()},{type:"primary",text:"\u7F16\u8F91",icon:"button-edit-filling",onClick:()=>k()},{type:"danger",text:"\u5220\u9664",icon:"button-delete",onClick:()=>B()}]),{searchForm:a}=Pe(ae({searchKeyInput:{onReset:()=>H(),onSearch:()=>d(),onExpand:()=>h()}})),{table:c,getTableData:p,onSortChange:A,columns:v,pagination:i,onSelectionChange:w}=Te({dataApi:xe,tableProps:{defaultSort:{isAsc:!1,sortColumns:"Id"}},searchForm:a}),f=y([]),H=()=>{ae().list.forEach(u=>{a.resetListValue(u)})},d=()=>{p()},h=()=>{a.list.forEach(n=>{n.hidden&&(n.show=!n.show)})},B=()=>{if(!c.selection.length)return S({type:"error",message:"\u8BF7\u52FE\u9009\u9700\u8981\u5220\u9664\u7684\u6570\u636E"});Se.confirm(`\u662F\u5426\u786E\u8BA4\u5220\u9664\u9009\u4E2D\u884C\uFF08${c.selection.length}\uFF09`,{title:"\u4FE1\u606F",type:"warning"}).then(()=>{Ne({ids:c.selection.map(n=>n.Id).join(",")}).then(n=>{S({type:"success",message:n.Data}),p()})})},k=()=>{if(!c.selection.length)return S({type:"error",message:"\u8BF7\u52FE\u9009\u9700\u8981\u5220\u9664\u7684\u6570\u636E"});if(c.selection.length>1)return S({type:"error",message:"\u53EA\u80FD\u540C\u65F6\u64CD\u4F5C\u4E00\u884C\u6570\u636E"});const{form:n}=K(),{list:u}=ne(c.selection[0]);f.push(n),n.update({type:"EDIT",show:!0,title:"[\u7F16\u8F91]\u4F9B\u5E94\u5546",list:u})},_=()=>{const{form:n}=K(),{list:u}=ne();f.push(n),n.update({type:"ADD",show:!0,title:"[\u65B0\u589E]\u4F9B\u5E94\u5546",list:u})},P=()=>{const{form:n}=K({appendToBody:!0}),{list:u}=Ie();f.push(n),n.update({type:"IMPORT",show:!0,title:"\u5BFC\u5165\u4F9B\u5E94\u5546",list:u})},T=(n,u)=>{n.Id=0,ue(n).then(b=>{F(u),S({type:"success",message:b.Message}),p()})},z=(n,u)=>{n.Id=c.selection[0].Id,ue(n).then(b=>{F(u),S({type:"success",message:b.Message}),p()})},s=(n,u)=>{const b=new FormData;b.append("fileExcel",n.fileExcel[0].raw),Me(b).then(Q=>{F(u),S({type:"success",message:Q.Message}),p()})},m=(n,u)=>{switch(u.type){case"ADD":return T(n,u);case"EDIT":return z(n,u);case"IMPORT":return s(n,u)}},F=n=>{n.update({show:!1}),f.splice(f.indexOf(n),1)};return p(),(n,u)=>{const b=D("my-button"),Q=D("my-search-form"),G=D("el-table-column"),se=D("el-table"),re=D("el-pagination"),ie=D("my-form"),ce=Ae("loading");return E(),I("div",We,[ee("div",Oe,[(E(!0),I(L,null,V(r(t),o=>(E(),x(b,{key:o.text,prop:o,onClick:o.onClick},null,8,["prop","onClick"]))),128)),q(Q,{form:r(a)},null,8,["form"])]),ee("div",Re,[Ce((E(),x(se,{height:"calc(96%)","header-cell-style":{fontWeight:"bold",color:"#333",background:"rgb(238,238,238)"},data:r(c).data,border:"",stripe:"",style:{width:"100%"},onSortChange:r(A),onSelectionChange:r(w)},{default:te(()=>[q(G,{type:"selection",width:"55"}),(E(!0),I(L,null,V(r(v),o=>(E(),x(G,{key:o.prop,prop:o.prop,label:o.label,"min-width":o.minWidth,align:o.align,sortable:o.sortable},{default:te($=>[Be(De($.row[o.prop]),1)]),_:2},1032,["prop","label","min-width","align","sortable"]))),128))]),_:1},8,["header-cell-style","data","onSortChange","onSelectionChange"])),[[ce,r(c).loading]]),q(re,{"current-page":r(i).currentPage,"onUpdate:current-page":u[0]||(u[0]=o=>r(i).currentPage=o),"page-size":r(i).pageSize,"onUpdate:page-size":u[1]||(u[1]=o=>r(i).pageSize=o),small:"","page-sizes":r(i).pageSizes,layout:r(i).layout,total:r(i).total,background:"",onSizeChange:u[2]||(u[2]=()=>r(p)()),onCurrentChange:u[3]||(u[3]=()=>r(p)())},null,8,["current-page","page-size","page-sizes","layout","total"])]),(E(!0),I(L,null,V(f,o=>(E(),x(ie,{key:o.id,form:o,onSubmit:$=>m($,o),onClose:()=>F(o)},null,8,["form","onSubmit","onClose"]))),128))])}}});export{Ue as default};
